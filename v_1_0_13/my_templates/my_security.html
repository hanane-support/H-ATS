{% extends "my_base.html" %}

{% block title %}ë³´ì•ˆ - H-ATS Admin{% endblock %}

{% block page_header %}ë³´ì•ˆ{% endblock %}

{% block content %}

<!-- ë„ë©”ì¸ ì¹´ë“œ -->
<div class="card security-card">
    <h2 class="card-title">ë„ë©”ì¸</h2>
    <p class="security-description-text">
        <span class="security-text-span">
            HTTP ëŠ” ë°ì´í„°ë¥¼ ì•”í˜¸í™”í•˜ì§€ ì•Šê³  ì „ì†¡í•˜ì§€ë§Œ, HTTPS ëŠ” SSL/TLS ë¡œ ë°ì´í„°ë¥¼ ì•”í˜¸í™”í•´ ë³´ì•ˆì„ ê°•í™”í•©ë‹ˆë‹¤.
            <br>HTTPS ë³´ì•ˆì„ ì ìš©í•˜ê¸° ìœ„í•´ ë„ë©”ì¸ ë“±ë¡ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
        </span>
    </p>
    <hr class="card-hr">

    <h3 class="section-header">ë„ë©”ì¸</h3>

    <div>
        <input type="text" id="domain-input" placeholder="example.com (ì˜ë¬¸ ë„ë©”ì¸ ê¶Œì¥)" class="domain-input"
            pattern="^([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,63}$"
            title="ìœ íš¨í•œ ë„ë©”ì¸ í˜•ì‹ (ì˜ˆ: example.com, sub.example.co.kr)">

        <div class="button-group">
            <button id="registerDomainButton" class="small-button accent-color-bg full-width-button" disabled>ë„ë©”ì¸
                ë“±ë¡</button>

            <button id="releaseDomainButton" class="small-button delete-button full-width-button" disabled>ë„ë©”ì¸
                í•´ì œ</button>
        </div>
    </div>

    <!-- ë„ë©”ì¸ ë° ë³´ì•ˆ ìƒíƒœ -->
    <div class="status-box" style="margin-top: 20px;">
        <div class="status-content">
            <p>
                <span class="status-label">ë„ë©”ì¸ :</span>
                <span class="status-value" id="currentDomainDisplay">{{ domain_name | default('ì—†ìŒ') }}</span>
                <button id="domainAccessButton" class="domain-access-button" style="display: none;"
                    data-tooltip="IP ì ‘ì†ì—ì„œ ë¡œê·¸ì•„ì›ƒí•˜ê³  ë„ë©”ì¸ìœ¼ë¡œ ì ‘ì†í•©ë‹ˆë‹¤.&#10;ë‹¤ì‹œ ë¡œê·¸ì¸ í•´ì•¼ í•©ë‹ˆë‹¤.">
                    ë„ë©”ì¸ ì ‘ì†
                </button>
            </p>

            <p>
                <span class="status-label">ë³´ì•ˆ :</span>
                <span id="securityStatusDisplay"
                    class="{% if security_status == 'HTTPS' %}status-value-success{% else %}status-value-error{% endif %}">
                    {% if security_status == 'HTTPS' %}
                    ì ìš© (HTTPS)
                    {% else %}
                    ë¯¸ì ìš© (HTTP)
                    {% endif %}
                </span>
            </p>
        </div>
    </div>
</div>

<!-- ì ‘ê·¼ í—ˆìš© IP ì¹´ë“œ -->
<div class="card ip-card">
    <h2 class="card-title">ì ‘ê·¼ í—ˆìš© IP</h2>
    <p class="security-description-text">
        <span class="security-text-span">
            ì›¹í›… ìš”ì²­ì„ í—ˆìš©í•  IP ì£¼ì†Œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.<br>ê´€ë¦¬ì IP ì™€ íŠ¸ë ˆì´ë”©ë·°ì˜ ê¸°ë³¸ IPê°€ ë¯¸ë¦¬ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
        </span>
    </p>
    <hr class="card-hr">

    <h3 class="section-header">
        ì ‘ê·¼ í—ˆìš© IP
        <span class="info-tooltip-icon"
            data-tooltip="{% if admin_ip %}ê´€ë¦¬ì IP&#10;{{ admin_ip }}&#10;&#10;{% endif %}íŠ¸ë ˆì´ë”©ë·° ê¸°ë³¸ IP&#10;52.89.214.238&#10;34.212.75.30&#10;54.218.53.128&#10;52.32.178.7">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" stroke="white" stroke-width="2" />
                <path d="M12 16V12" stroke="white" stroke-width="2" stroke-linecap="round" />
                <circle cx="12" cy="8" r="1" fill="white" />
            </svg>
        </span>
    </h3>

    <div>
        <textarea id="allowed-ips-input" placeholder="IP ì£¼ì†Œë¥¼ ì‰¼í‘œë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥í•˜ì„¸ìš”" class="webhook-input"
            rows="3">{{ allowed_ips }}</textarea>

        <div class="button-group">
            <button id="registerIpsButton" class="small-button accent-color-bg full-width-button">ì ‘ê·¼ í—ˆìš© IP ë“±ë¡</button>
            <button id="releaseIpsButton" class="small-button delete-button full-width-button" {% if not allowed_ips or
                allowed_ips==default_allowed_ips %}disabled{% endif %}>ì ‘ê·¼ í—ˆìš© IP
                í•´ì œ</button>
        </div>
    </div>
</div>

<!-- íŠ¸ë ˆì´ë”©ë·° ì¹´ë“œ -->
<div class="card webhook-card">
    <h2 class="card-title">íŠ¸ë ˆì´ë”©ë·°</h2>
    <p class="security-description-text">
        <span class="security-text-span">
            ì£¼ë¬¸ ì •ë³´ë¥¼ ë°›ì„ ì›¹í›… ì£¼ì†Œì™€ ê´€ë¦¬ì ì¸ì¦ì„ ìœ„í•œ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
        </span>
    </p>
    <hr class="card-hr">

    <h3 class="section-header">
        ì›¹í›… ì£¼ì†Œ
        <span class="info-tooltip-icon"
            data-tooltip="ì›¹í›… URLì˜ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.&#10;&#10;â€¢ ë„ë©”ì¸ì´ ë“±ë¡ë˜ì–´ ìˆìœ¼ë©´ ë„ë©”ì¸ ì‚¬ìš©&#10;â€¢ ë„ë©”ì¸ì´ ì—†ìœ¼ë©´ ê´€ë¦¬ì IP ì‚¬ìš©&#10;â€¢ ì—”ë“œí¬ì¸íŠ¸ ê¸°ë³¸ê°’ /webhook&#10;&#10;ì˜ˆì‹œ:&#10;https://ë„ë©”ì¸/webhook&#10;http://ê´€ë¦¬ì IP/webhook">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" stroke="white" stroke-width="2" />
                <path d="M12 16V12" stroke="white" stroke-width="2" stroke-linecap="round" />
                <circle cx="12" cy="8" r="1" fill="white" />
            </svg>
        </span>
    </h3>

    <div>
        <input type="text" id="webhook-endpoint-input" placeholder="ì˜ˆ: webhook" class="webhook-input"
            value="{{ webhook_endpoint.lstrip('/') if webhook_endpoint else 'webhook' }}">

        <div class="button-group">
            <button id="registerEndpointButton" class="small-button accent-color-bg full-width-button">ì›¹í›… ì£¼ì†Œ ë“±ë¡</button>
            <button id="releaseEndpointButton" class="small-button delete-button full-width-button" {% if not
                webhook_endpoint or webhook_endpoint=='/webhook' %}disabled{% endif %}>ì›¹í›… ì£¼ì†Œ í•´ì œ</button>
        </div>
    </div>

    <!-- ì›¹í›… ì£¼ì†Œ í’€ í‘œì‹œ -->
    <div class="status-box" style="margin-top: 15px;">
        <div class="status-content">
            <p style="margin: 0;">
                <span class="status-label">ì›¹í›… URL :</span>
                <span class="status-value-url" id="webhookFullUrl">{% if domain_name and domain_name != 'ì—†ìŒ' %}https://{{
                    domain_name }}{{ webhook_endpoint }}{% else %}http://{{ admin_ip }}{{ webhook_endpoint }}{% endif
                    %}</span>
                <button id="copyWebhookUrlButton" class="copy-button" data-tooltip="í´ë¦­í•˜ì—¬ ì›¹í›… URL ë³µì‚¬">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="9" y="9" width="13" height="13" rx="2" stroke="currentColor" stroke-width="2" />
                        <path
                            d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5"
                            stroke="currentColor" stroke-width="2" />
                    </svg>
                </button>
            </p>
        </div>
    </div>

    <h3 class="section-header">
        ì›¹í›… íŒ¨ìŠ¤ì›Œë“œ
        <span class="info-tooltip-icon"
            data-tooltip="â€¢ ìµœì†Œ ê¸¸ì´: 4ì ì´ìƒ&#10;â€¢ ë¬¸ì ì¡°í•©: ì œí•œ ì—†ìŒ&#10;&#10;âœ… ìˆ«ìë§Œ: 1234&#10;âœ… ì˜ë¬¸ë§Œ: ABCD ë˜ëŠ” abcd&#10;âœ… ì˜ë¬¸+ìˆ«ì: abc123&#10;âœ… íŠ¹ìˆ˜ë¬¸ì: abc@123!&#10;âœ… í•œê¸€: í•œê¸€íŒ¨ìŠ¤ì›Œë“œ&#10;âœ… ê³µë°±: ì¤‘ê°„ ê³µë°± ê°€ëŠ¥">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" stroke="white" stroke-width="2" />
                <path d="M12 16V12" stroke="white" stroke-width="2" stroke-linecap="round" />
                <circle cx="12" cy="8" r="1" fill="white" />
            </svg>
        </span>
    </h3>

    <div>
        <div style="position: relative; margin-bottom: 25px;">
            <input type="password" id="webhook-password-input" placeholder="ìµœì†Œ 4ì ì´ìƒ" class="webhook-input"
                value="{{ webhook_password }}" style="padding-right: 40px; margin-bottom: 0;">
            <button type="button" class="password-toggle-btn" data-target="webhook-password-input"
                style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: transparent; border: none; cursor: pointer; padding: 5px; display: flex; align-items: center; color: #9ca3af; opacity: 0.7; transition: opacity 0.3s;"
                onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.7'">
                <svg class="eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" stroke="currentColor" stroke-width="2" />
                    <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" />
                </svg>
                <svg class="eye-slash-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    xmlns="http://www.w3.org/2000/svg" style="display: none;">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" stroke="currentColor" stroke-width="2" />
                    <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" />
                    <line x1="1" y1="1" x2="23" y2="23" stroke="currentColor" stroke-width="2" />
                </svg>
            </button>
        </div>

        <div class="button-group">
            <button id="registerWebhookButton" class="small-button accent-color-bg full-width-button">ì›¹í›… íŒ¨ìŠ¤ì›Œë“œ
                ë“±ë¡</button>
            <button id="releaseWebhookButton" class="small-button delete-button full-width-button" {% if not
                webhook_password %}disabled{% endif %}>ì›¹í›… íŒ¨ìŠ¤ì›Œë“œ í•´ì œ</button>
        </div>
    </div>

    <div class="info-box">
        <h4 class="info-header">íŠ¸ë ˆì´ë”©ë·° ì–¼ëŸ¬íŠ¸ ë©”ì„¸ì§€ ì…ë ¥ ë°©ë²•</h4>
        <p class="info-text">
            ì–¼ëŸ¬íŠ¸ ë©”ì‹œì§€ ì…ë ¥ë€ì— ë¶™ì—¬ë„£ê¸° í•©ë‹ˆë‹¤.
        </p>
        <div class="code-block-container">
            <button id="copyJsonButton" class="copy-json-icon-button" data-tooltip="JSON ë³µì‚¬">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="9" y="9" width="13" height="13" rx="2" stroke="currentColor" stroke-width="2" />
                    <path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5"
                        stroke="currentColor" stroke-width="2" />
                </svg>
            </button>
            <pre class="code-block" id="tradingviewJson">{
  "admin_id": "{{ user_id }}",
  "webhook_password": "{{ webhook_password if webhook_password else 'ì—¬ê¸°ì—_ìœ„ì—ì„œ_ì„¤ì •í•œ_íŒ¨ìŠ¤ì›Œë“œ' }}",
  "id": "{% raw %}{{strategy.order.id}}{% endraw %}",
  "comment": "{% raw %}{{strategy.order.comment}}{% endraw %}",
  "exchange": "{% raw %}{{exchange}}{% endraw %}",
  "ticker": "{% raw %}{{ticker}}{% endraw %}",
  "basecurrency": "{% raw %}{{syminfo.basecurrency}}{% endraw %}",
  "currency": "{% raw %}{{syminfo.currency}}{% endraw %}",
  "prev_market_position": "{% raw %}{{strategy.prev_market_position}}{% endraw %}",
  "action": "{% raw %}{{strategy.order.action}}{% endraw %}",
  "market_position": "{% raw %}{{strategy.market_position}}{% endraw %}",
  "price": "{% raw %}{{strategy.order.price}}{% endraw %}",
  "contracts": "{% raw %}{{strategy.order.contracts}}{% endraw %}"
}</pre>
        </div>
    </div>
</div>

<!-- ë„ë©”ì¸ ë“±ë¡ í™•ì¸ ëª¨ë‹¬ -->
<div id="registerDomainModal" class="modal-overlay hidden-modal">
    <div class="modal-content">
        <h3 class="modal-header-success">ë„ë©”ì¸ ë“±ë¡ í™•ì¸</h3>
        <p class="modal-text" id="registerModalText">
            (<span id="modal-domain-display"></span>) ì„ ë„ë©”ì¸ìœ¼ë¡œ ë“±ë¡í•©ë‹ˆë‹¤. <br><br>
            <span class="modal-text-success">ë“±ë¡ í›„ SSL/TLS ë³´ì•ˆ ì ìš©ì´ ì‹œì‘ë©ë‹ˆë‹¤.</span>
        </p>
        <!-- ì‹¤ì‹œê°„ ì§„í–‰ ìƒí™© í‘œì‹œ ì˜ì—­ (ì²˜ìŒì—ëŠ” ìˆ¨ê¹€) -->
        <div id="registerProgressContainer" class="progress-container hidden-modal">
            <p id="registerProgressText" class="progress-text"></p>
        </div>
        <div class="modal-actions">
            <button id="confirmRegisterDomain" class="small-button accent-color-bg">
                ë“±ë¡
            </button>
            <button id="cancelRegisterDomain" class="small-button secondary-color-bg">
                ì·¨ì†Œ
            </button>
        </div>
    </div>
</div>

<!-- ë„ë©”ì¸ í•´ì œ í™•ì¸ ëª¨ë‹¬ -->
<div id="releaseDomainModal" class="modal-overlay hidden-modal">
    <div class="modal-content">
        <h3 class="modal-header-danger">ë„ë©”ì¸ í•´ì œ í™•ì¸</h3>
        <p class="modal-text" id="releaseModalText">
            ë„ë©”ì¸ì„ í•´ì œí•˜ê³  IP (HTTP) ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤. <br>
            <br>
            <span class="modal-text-danger">ë³´ì•ˆì´ ì·¨ì•½í•´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
        </p>
        <!-- ì‹¤ì‹œê°„ ì§„í–‰ ìƒí™© í‘œì‹œ ì˜ì—­ (ì²˜ìŒì—ëŠ” ìˆ¨ê¹€) -->
        <div id="releaseProgressContainer" class="progress-container hidden-modal">
            <p id="releaseProgressText" class="progress-text"></p>
        </div>
        <div class="modal-actions">
            <button id="confirmReleaseDomain" class="small-button delete-button-confirm">
                í•´ì œ
            </button>
            <button id="cancelReleaseDomain" class="small-button secondary-color-bg">
                ì·¨ì†Œ
            </button>
        </div>
    </div>
</div>

<!-- ì›¹í›… ì£¼ì†Œ ë“±ë¡ í™•ì¸ ëª¨ë‹¬ -->
<div id="registerEndpointModal" class="modal-overlay hidden-modal">
    <div class="modal-content">
        <h3 class="modal-header-success">ì›¹í›… ì£¼ì†Œ ë“±ë¡ í™•ì¸</h3>
        <p class="modal-text">
            ì›¹í›… ì£¼ì†Œë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.<br><br>
            <span class="modal-text-success">íŠ¸ë ˆì´ë”©ë·° ì›¹í›… URLì— ì´ ì£¼ì†Œê°€ í¬í•¨ë©ë‹ˆë‹¤.</span>
        </p>
        <div class="modal-actions">
            <button id="confirmRegisterEndpoint" class="small-button accent-color-bg">ë“±ë¡</button>
            <button id="cancelRegisterEndpoint" class="small-button secondary-color-bg">ì·¨ì†Œ</button>
        </div>
    </div>
</div>

<!-- ì›¹í›… ì£¼ì†Œ í•´ì œ í™•ì¸ ëª¨ë‹¬ -->
<div id="releaseEndpointModal" class="modal-overlay hidden-modal">
    <div class="modal-content">
        <h3 class="modal-header-danger">ì›¹í›… ì£¼ì†Œ í•´ì œ í™•ì¸</h3>
        <p class="modal-text">
            ì›¹í›… ì£¼ì†Œë¥¼ ê¸°ë³¸ê°’(/webhook)ìœ¼ë¡œ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.<br><br>
            <span class="modal-text-danger">ê¸°ì¡´ ì„¤ì •ëœ ì›¹í›… ì£¼ì†Œê°€ ì‚­ì œë©ë‹ˆë‹¤.</span>
        </p>
        <div class="modal-actions">
            <button id="confirmReleaseEndpoint" class="small-button delete-button-confirm">í•´ì œ</button>
            <button id="cancelReleaseEndpoint" class="small-button secondary-color-bg">ì·¨ì†Œ</button>
        </div>
    </div>
</div>

<!-- ì›¹í›… íŒ¨ìŠ¤ì›Œë“œ ë“±ë¡ í™•ì¸ ëª¨ë‹¬ -->
<div id="registerWebhookModal" class="modal-overlay hidden-modal">
    <div class="modal-content">
        <h3 class="modal-header-success">ì›¹í›… íŒ¨ìŠ¤ì›Œë“œ ë“±ë¡ í™•ì¸</h3>
        <p class="modal-text">
            ì›¹í›… íŒ¨ìŠ¤ì›Œë“œë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.<br><br>
            <span class="modal-text-success">íŠ¸ë ˆì´ë”©ë·° ì•Œë¦¼ ë©”ì‹œì§€ì— ì´ íŒ¨ìŠ¤ì›Œë“œë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.</span>
        </p>
        <div class="modal-actions">
            <button id="confirmRegisterWebhook" class="small-button accent-color-bg">ë“±ë¡</button>
            <button id="cancelRegisterWebhook" class="small-button secondary-color-bg">ì·¨ì†Œ</button>
        </div>
    </div>
</div>

<!-- ì›¹í›… íŒ¨ìŠ¤ì›Œë“œ í•´ì œ í™•ì¸ ëª¨ë‹¬ -->
<div id="releaseWebhookModal" class="modal-overlay hidden-modal">
    <div class="modal-content">
        <h3 class="modal-header-danger">ì›¹í›… íŒ¨ìŠ¤ì›Œë“œ í•´ì œ í™•ì¸</h3>
        <p class="modal-text">
            ì›¹í›… íŒ¨ìŠ¤ì›Œë“œë¥¼ í•´ì œí•©ë‹ˆë‹¤.<br><br>
            <span class="modal-text-danger">ë” ì´ìƒ íŠ¸ë ˆì´ë”©ë·°ì—ì„œ ì£¼ë¬¸ì„ ë°›ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</span>
        </p>
        <div class="modal-actions">
            <button id="confirmReleaseWebhook" class="small-button delete-button-confirm">í•´ì œ</button>
            <button id="cancelReleaseWebhook" class="small-button secondary-color-bg">ì·¨ì†Œ</button>
        </div>
    </div>
</div>

<!-- ë©”ì‹œì§€ ëª¨ë‹¬ -->
<div id="messageModal" class="modal-overlay hidden-modal">
    <div class="modal-content">
        <h3 id="messageModalHeader" class="modal-header-success"></h3>
        <p id="messageModalText" class="modal-text"></p>
        <div class="modal-actions">
            <button id="closeMessageModal" class="small-button secondary-color-bg">í™•ì¸</button>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_head_styles %}
<style>
    .card {
        background-color: var(--header-bg-dark);
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
        border: 1px solid var(--border-color-dark);
        margin-bottom: 30px;
    }

    .webhook-card {
        margin-bottom: 0;
    }

    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
    }

    .hidden-modal {
        display: none !important;
    }

    .modal-content {
        background-color: var(--header-bg-dark);
        padding: 25px;
        border-radius: 8px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        border: 1px solid var(--border-color-dark);
        max-width: 500px;
        width: 90%;
        text-align: center;
    }

    .modal-header-success {
        color: #8BC34A;
        font-size: 1.5em;
        margin-bottom: 30px;
        margin-top: 0;
    }

    .modal-header-danger {
        color: #ff4d4d;
        font-size: 1.5em;
        margin-bottom: 30px;
        margin-top: 0;
    }

    .modal-text {
        color: var(--text-color-light);
        margin-bottom: 15px;
        line-height: 1.4;
        font-size: 1em;
    }

    .modal-text-success {
        color: #83ff52;
    }

    .modal-text-danger {
        color: #ff4d4d;
        margin-bottom: 25px;
        font-size: 1em;
    }

    .modal-actions {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 30px;
    }

    .card-title {
        color: var(--subtitle-color);
        margin-top: 0;
        margin-bottom: 10px;
        font-size: 1.5em;
    }

    .security-description-text {
        color: var(--text-color-light);
        margin-top: 5px;
        margin-bottom: 15px;
        line-height: 1.4;
    }

    .card-hr {
        border: 0;
        height: 1px;
        background-color: var(--border-color-dark);
        margin-top: 20px;
        margin-bottom: 30px;
    }

    .section-header {
        color: var(--text-color-light);
        margin-top: 35px;
        margin-bottom: 10px;
        font-size: 1.2em;
    }

    .webhook-input {
        width: 100%;
        padding: 12px;
        margin-top: 0;
        margin-bottom: 25px;
        border: 1px solid #444;
        border-radius: 6px;
        background-color: var(--sidebar-bg-dark);
        color: var(--text-color-light);
        font-size: 1em;
        box-sizing: border-box;
    }

    .webhook-input:focus {
        outline: none;
        border-color: var(--accent-color);
    }

    .button-group {
        display: flex;
        gap: 10px;
        margin-top: 0px;
        margin-bottom: 30px;
    }

    .small-button {
        padding: 10px 15px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s, opacity 0.3s;
        color: var(--text-color-light);
        font-size: 1em;
        flex-grow: 1;
    }

    .small-button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .accent-color-bg {
        background-color: var(--accent-color);
    }

    .accent-color-bg:hover:not(:disabled) {
        background-color: #0056b3;
    }

    .secondary-color-bg {
        background-color: #6c757d;
        color: white;
    }

    .secondary-color-bg:hover {
        background-color: #5a6268;
    }

    .delete-button {
        background-color: #dc3545;
        color: white;
    }

    .delete-button:hover:not(:disabled) {
        background-color: #c82333;
    }

    .delete-button-confirm {
        background-color: #dc3545;
        color: white;
    }

    .delete-button-confirm:hover {
        background-color: #c82333;
    }

    .full-width-button {
        padding: 10px 20px;
        border-radius: 6px;
    }

    /* ì•ˆë‚´ ë°•ìŠ¤ */
    .info-box {
        background-color: var(--sidebar-bg-dark);
        padding: 20px;
        border-radius: 6px;
        border: 1px solid #444;
        margin-top: 30px;
    }

    .info-header {
        color: var(--subtitle-color);
        margin-top: 0;
        margin-bottom: 15px;
        font-size: 1.1em;
    }

    .info-text {
        color: var(--text-color-light);
        margin-bottom: 10px;
        line-height: 1.4;
    }

    .code-block {
        background-color: #1a1a1a;
        color: #ffffff;
        padding: 15px;
        border-radius: 4px;
        border: 1px solid #333;
        overflow-x: auto;
        font-family: 'Courier New', monospace;
        font-size: 0.9em;
        line-height: 1.5;
        margin: 10px 0;
    }

    /* ì„œë²„ ìƒíƒœ ë°•ìŠ¤ */
    .status-box {
        margin-top: 0;
        padding: 15px;
        border: 1px solid var(--border-color-dark);
        border-radius: 8px;
        background-color: var(--sidebar-bg-dark);
    }

    .status-content p {
        margin: 12px 0;
        line-height: 1.1;
    }

    .status-label {
        color: var(--text-color-light);
        display: inline-block;
        width: 80px;
    }

    .status-value {
        color: var(--text-color-dark);
    }

    .status-value-ip {
        color: #fffb00;
        font-size: 1.1em;
    }

    .status-value-success {
        color: #22ff00;
    }

    .status-value-error {
        color: #EF5350;
    }

    .required-mark {
        color: #EF5350;
        font-size: 0.9em;
        font-weight: normal;
    }

    /* ë„ë©”ì¸ ì…ë ¥ */
    .domain-input {
        width: 100%;
        padding: 12px;
        margin-top: 0;
        margin-bottom: 25px;
        border: 1px solid #444;
        border-radius: 6px;
        background-color: var(--sidebar-bg-dark);
        color: var(--text-color-light);
        font-size: 1em;
        box-sizing: border-box;
    }

    .domain-input:focus {
        outline: none;
        border-color: var(--accent-color);
    }

    /* ë„ë©”ì¸ ì ‘ì† ë²„íŠ¼ */
    .domain-access-button {
        margin-left: 5px;
        padding: 6px 6px;
        background-color: var(--accent-color);
        color: white;
        border: none;
        border-radius: 4px;
        font-size: 0.8em;
        cursor: pointer;
        transition: background-color 0.3s;
        position: relative;
        vertical-align: middle;
        line-height: 1.0;
        margin-top: -4px;
    }

    .domain-access-button:hover {
        background-color: #0056b3;
    }

    .domain-access-button:hover::after {
        content: attr(data-tooltip);
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        bottom: -80px;
        background-color: #2a3f5f;
        color: var(--text-color-light);
        padding: 10px 12px;
        border-radius: 6px;
        font-size: 1.1em;
        white-space: pre;
        text-align: center;
        z-index: 1000;
        border: 1px solid var(--border-color-dark);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        line-height: 1.5;
    }

    .domain-access-button:hover::before {
        content: '';
        position: absolute;
        bottom: -8px;
        left: 50%;
        transform: translateX(-50%);
        border: 6px solid transparent;
        border-bottom-color: #2a3f5f;
        z-index: 1001;
    }

    /* ì§„í–‰ ìƒí™© í‘œì‹œ */
    .progress-container {
        margin-top: 20px;
        margin-bottom: 20px;
        padding: 15px;
        background-color: var(--sidebar-bg-dark);
        border: 1px solid var(--border-color-dark);
        border-radius: 6px;
    }

    .progress-text {
        color: #f2ff00;
        margin: 0;
        font-size: 1em;
        line-height: 1.6;
        text-align: center;
    }

    .progress-text.success {
        color: #22ff00;
    }

    .progress-text.error {
        color: #EF5350;
    }

    #releaseDomainModal .modal-header-danger {
        color: #ff4d4d;
    }

    /* ë³µì‚¬ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .copy-button {
        margin-left: 10px;
        padding: 6px 8px;
        background-color: transparent;
        color: var(--text-color-light);
        border: 1px solid var(--text-color-light);
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s;
        vertical-align: middle;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }

    .copy-button:hover {
        background-color: var(--accent-color);
        border-color: var(--accent-color);
        color: white;
    }

    .copy-button svg {
        display: block;
    }

    .code-block-container {
        position: relative;
    }

    .copy-json-icon-button {
        position: absolute;
        top: 10px;
        right: 10px;
        padding: 6px 8px;
        background-color: rgba(255, 255, 255, 0.1);
        color: var(--text-color-light);
        border: 1px solid var(--text-color-light);
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        z-index: 10;
    }

    .copy-json-icon-button:hover {
        background-color: var(--accent-color);
        border-color: var(--accent-color);
        color: white;
    }

    .copy-json-icon-button svg {
        display: block;
    }

    .status-value-url {
        color: #f2ff00;
        font-size: 0.95em;
        word-break: break-all;
    }

    textarea.webhook-input {
        resize: vertical;
        font-family: 'Courier New', monospace;
    }

    /* íˆ´íŒ ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
    .info-tooltip-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-left: 8px;
        cursor: help;
        position: relative;
        vertical-align: -3px;
    }

    .info-tooltip-icon svg {
        display: block;
    }

    .info-tooltip-icon:hover::after {
        content: attr(data-tooltip);
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        top: 30px;
        background-color: #2a3f5f;
        color: var(--text-color-light);
        padding: 12px 15px;
        border-radius: 6px;
        font-size: 0.8em;
        white-space: pre-line;
        text-align: left;
        z-index: 1000;
        border: 1px solid var(--border-color-dark);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        line-height: 1.6;
        min-width: 280px;
        font-weight: normal;
    }

    .info-tooltip-icon:hover::before {
        content: '';
        position: absolute;
        top: 22px;
        left: 50%;
        transform: translateX(-50%);
        border: 6px solid transparent;
        border-bottom-color: #2a3f5f;
        z-index: 1001;
    }
</style>
{% endblock %}

{% block page_script %}
<script>
    const BASE_URL = '/admin/security';
    const DOMAIN_BASE_URL = '/admin/domain';

    // ë“±ë¡ ì„±ê³µ ì‹œ ê°’ì„ ìœ ì§€í•˜ê¸° ìœ„í•œ ë³€ìˆ˜
    let currentDomain = '';

    document.addEventListener('DOMContentLoaded', () => {
        // ===== ë„ë©”ì¸ ê´€ë¦¬ ìš”ì†Œ =====
        const registerDomainButton = document.getElementById('registerDomainButton');
        const registerDomainModal = document.getElementById('registerDomainModal');
        const confirmRegisterDomain = document.getElementById('confirmRegisterDomain');
        const cancelRegisterDomain = document.getElementById('cancelRegisterDomain');

        const releaseDomainButton = document.getElementById('releaseDomainButton');
        const releaseDomainModal = document.getElementById('releaseDomainModal');
        const confirmReleaseDomain = document.getElementById('confirmReleaseDomain');
        const cancelReleaseDomain = document.getElementById('cancelReleaseDomain');

        const domainInput = document.getElementById('domain-input');
        const modalDomainDisplay = document.getElementById('modal-domain-display');

        // ìƒíƒœ í‘œì‹œ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ ìš”ì†Œ
        const currentDomainDisplay = document.getElementById('currentDomainDisplay');
        const securityStatusDisplay = document.getElementById('securityStatusDisplay');
        const domainAccessButton = document.getElementById('domainAccessButton');

        // ê´€ë¦¬ì IP ìš”ì†Œ ê°€ì ¸ì˜¤ê¸° (ì„œë²„ì—ì„œ ì „ë‹¬ëœ ê°’)
        const homeIp = '{{ admin_ip }}' || '';

        // ===== ì›¹í›… ê´€ë¦¬ ìš”ì†Œ =====
        const registerButton = document.getElementById('registerWebhookButton');
        const registerModal = document.getElementById('registerWebhookModal');
        const confirmRegister = document.getElementById('confirmRegisterWebhook');
        const cancelRegister = document.getElementById('cancelRegisterWebhook');

        const releaseButton = document.getElementById('releaseWebhookButton');
        const releaseModal = document.getElementById('releaseWebhookModal');
        const confirmRelease = document.getElementById('confirmReleaseWebhook');
        const cancelRelease = document.getElementById('cancelReleaseWebhook');

        const webhookInput = document.getElementById('webhook-password-input');

        const messageModal = document.getElementById('messageModal');
        const messageModalHeader = document.getElementById('messageModalHeader');
        const messageModalText = document.getElementById('messageModalText');
        const closeMessageModal = document.getElementById('closeMessageModal');

        // ë©”ì‹œì§€ ëª¨ë‹¬ í‘œì‹œ í•¨ìˆ˜
        const showMessage = (header, text, isSuccess = true) => {
            messageModalHeader.textContent = header;
            messageModalText.innerHTML = text;

            messageModalHeader.classList.remove('modal-header-danger', 'modal-header-success');
            if (isSuccess) {
                messageModalHeader.classList.add('modal-header-success');
            } else {
                messageModalHeader.classList.add('modal-header-danger');
            }

            messageModal.classList.remove('hidden-modal');
        };

        // ëª¨ë‹¬ ë‹«ê¸°
        closeMessageModal.addEventListener('click', () => {
            messageModal.classList.add('hidden-modal');
        });

        // ====================================================
        // ë„ë©”ì¸ ê´€ë¦¬ ë¡œì§
        // ====================================================

        // ì´ˆê¸° ìƒíƒœ ë™ê¸°í™”
        const initialDomainText = currentDomainDisplay.textContent.trim();
        if (initialDomainText !== 'ì—†ìŒ' && initialDomainText !== '') {
            currentDomain = initialDomainText;
            domainInput.value = currentDomain;
        }

        // ë„ë©”ì¸ ì ‘ì† ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€
        const updateDomainAccessButton = () => {
            const hasDomain = currentDomain && currentDomain !== '' && currentDomain !== 'ì—†ìŒ';
            const isHttps = securityStatusDisplay.textContent.includes('HTTPS') ||
                securityStatusDisplay.textContent.includes('ì ìš©');

            if (hasDomain && isHttps) {
                domainAccessButton.style.display = 'inline-block';
            } else {
                domainAccessButton.style.display = 'none';
            }
        };

        updateDomainAccessButton();

        // ë„ë©”ì¸ ì ‘ì† ë²„íŠ¼ í´ë¦­
        domainAccessButton.addEventListener('click', async () => {
            const domain = currentDomain;
            if (!domain || domain === 'ì—†ìŒ') {
                showMessage("ì˜¤ë¥˜", "ë“±ë¡ëœ ë„ë©”ì¸ì´ ì—†ìŠµë‹ˆë‹¤.", false);
                return;
            }

            try {
                await fetch('/logout', { method: 'POST' });
                const domainUrl = `https://${domain}/login`;
                window.location.href = domainUrl;
            } catch (error) {
                console.error('ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:', error);
                const domainUrl = `https://${domain}/login`;
                window.location.href = domainUrl;
            }
        });

        // ë„ë©”ì¸ ìœ íš¨ì„± ê²€ì‚¬
        const validateDomainInputs = () => {
            const domain = domainInput.value.trim();
            const isDomainValid = domain && domainInput.checkValidity();

            if (isDomainValid) {
                registerDomainButton.disabled = false;
            } else {
                registerDomainButton.disabled = true;
            }
        };

        // ë„ë©”ì¸ í•´ì œ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        const updateReleaseButtonState = () => {
            const hasDomain = currentDomain && currentDomain !== '' && currentDomain !== 'ì—†ìŒ';
            const isHttps = securityStatusDisplay.textContent.includes('HTTPS') ||
                securityStatusDisplay.textContent.includes('ì ìš©');
            const hasDomainInput = domainInput.value.trim() !== '';

            if (hasDomain && isHttps && hasDomainInput) {
                releaseDomainButton.disabled = false;
            } else {
                releaseDomainButton.disabled = true;
            }
        };

        domainInput.addEventListener('input', () => {
            validateDomainInputs();
            updateReleaseButtonState();
        });

        validateDomainInputs();
        updateReleaseButtonState();

        // ë„ë©”ì¸ ë“±ë¡ ë²„íŠ¼ í´ë¦­
        registerDomainButton.addEventListener('click', () => {
            const domain = domainInput.value.trim();

            if (!domain) {
                showMessage("ì˜¤ë¥˜", "ë„ë©”ì¸ì„ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.", false);
                return;
            }

            if (domainInput.checkValidity() === false) {
                showMessage("ì˜¤ë¥˜", "ìœ íš¨í•œ ë„ë©”ì¸ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.<br>ì˜ˆ: example.com, sub.example.co.kr", false);
                return;
            }

            modalDomainDisplay.textContent = domain;
            registerDomainModal.classList.remove('hidden-modal');
        });

        // ë„ë©”ì¸ ë“±ë¡ í™•ì¸ (SSE)
        let isRegisteringDomain = false;

        confirmRegisterDomain.addEventListener('click', async () => {
            if (isRegisteringDomain) return;

            const domain = domainInput.value.trim();
            const registerModalText = document.getElementById('registerModalText');
            const registerProgressContainer = document.getElementById('registerProgressContainer');
            const registerProgressText = document.getElementById('registerProgressText');

            registerModalText.classList.add('hidden-modal');
            registerProgressContainer.classList.remove('hidden-modal');
            registerProgressText.textContent = 'â³ ë„ë©”ì¸ ë“±ë¡ì„ ì‹œì‘í•©ë‹ˆë‹¤...';
            registerProgressText.className = 'progress-text';

            confirmRegisterDomain.disabled = true;
            isRegisteringDomain = true;

            try {
                const response = await fetch(`${DOMAIN_BASE_URL}/apply_security`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ domain: domain })
                });

                if (!response.ok) throw new Error(`ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ${response.status}`);

                const reader = response.body.getReader();
                const decoder = new TextDecoder();
                let buffer = '';

                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;

                    buffer += decoder.decode(value, { stream: true });
                    const lines = buffer.split('\n');
                    buffer = lines.pop() || '';

                    for (const line of lines) {
                        if (line.startsWith('data: ')) {
                            const jsonStr = line.substring(6).trim();
                            if (!jsonStr) continue;

                            try {
                                const data = JSON.parse(jsonStr);

                                if (data.status === 'progress') {
                                    registerProgressText.textContent = `${data.message}`;
                                    registerProgressText.className = 'progress-text';
                                } else if (data.status === 'success') {
                                    currentDomainDisplay.textContent = domain;
                                    currentDomain = domain;
                                    domainInput.value = currentDomain;

                                    securityStatusDisplay.textContent = 'ì ìš© (HTTPS)';
                                    securityStatusDisplay.classList.remove('status-value-error');
                                    securityStatusDisplay.classList.add('status-value-success');

                                    registerProgressText.textContent = 'ë„ë©”ì¸ ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.';
                                    registerProgressText.className = 'progress-text success';

                                    updateReleaseButtonState();
                                    updateDomainAccessButton();
                                    validateWebhookEndpoint(); // ì›¹í›… URL ì—…ë°ì´íŠ¸

                                    confirmRegisterDomain.textContent = 'í™•ì¸';
                                    confirmRegisterDomain.disabled = false;
                                    isRegisteringDomain = false;
                                    break;
                                } else if (data.status === 'rate_limited') {
                                    // Rate Limit ì—ëŸ¬ ì²˜ë¦¬
                                    securityStatusDisplay.textContent = 'ë¯¸ì ìš© (HTTP)';
                                    securityStatusDisplay.classList.remove('status-value-success');
                                    securityStatusDisplay.classList.add('status-value-error');

                                    // Rate Limit ìƒì„¸ ì •ë³´ í‘œì‹œ
                                    let rateLimitMsg = data.message;
                                    if (data.rate_limit_info) {
                                        const retryDate = new Date(data.rate_limit_info.retry_after);
                                        const retryDateStr = retryDate.toLocaleString('ko-KR', {
                                            year: 'numeric',
                                            month: 'long',
                                            day: 'numeric',
                                            hour: '2-digit',
                                            minute: '2-digit'
                                        });
                                        rateLimitMsg = `ğŸš« Let's Encrypt ì¸ì¦ì„œ ë°œê¸‰ ì œí•œ\n\n` +
                                                      `ì‚¬ìœ : ${data.rate_limit_info.message}\n` +
                                                      `ì¬ì‹œë„ ê°€ëŠ¥ ì¼ì‹œ: ${retryDateStr}\n\n` +
                                                      `ğŸ’¡ í•´ê²° ë°©ë²•:\n` +
                                                      `1. ê¸°ì¡´ ì¸ì¦ì„œê°€ ìˆë‹¤ë©´ ì¬ì‚¬ìš©ë©ë‹ˆë‹¤.\n` +
                                                      `2. ë°œê¸‰ ì œí•œì´ í•´ì œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.\n` +
                                                      `3. ë‹¤ë¥¸ ë„ë©”ì¸ìœ¼ë¡œ ì‹œë„í•˜ê±°ë‚˜, ê¸°ì¡´ ë„ë©”ì¸ì„ ìœ ì§€í•´ì£¼ì„¸ìš”.`;
                                    }

                                    registerProgressText.textContent = rateLimitMsg;
                                    registerProgressText.className = 'progress-text error';

                                    confirmRegisterDomain.textContent = 'í™•ì¸';
                                    confirmRegisterDomain.disabled = false;
                                    isRegisteringDomain = false;
                                    break;
                                } else if (data.status === 'error') {
                                    securityStatusDisplay.textContent = 'ë¯¸ì ìš© (HTTP)';
                                    securityStatusDisplay.classList.remove('status-value-success');
                                    securityStatusDisplay.classList.add('status-value-error');

                                    registerProgressText.textContent = `ë“±ë¡ ì‹¤íŒ¨: ${data.message}`;
                                    registerProgressText.className = 'progress-text error';

                                    confirmRegisterDomain.textContent = 'í™•ì¸';
                                    confirmRegisterDomain.disabled = false;
                                    isRegisteringDomain = false;
                                    break;
                                }
                            } catch (parseError) {
                                console.error("JSON íŒŒì‹± ì˜¤ë¥˜:", parseError);
                            }
                        }
                    }
                }
            } catch (error) {
                registerProgressText.textContent = `âŒ ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`;
                registerProgressText.className = 'progress-text error';

                securityStatusDisplay.textContent = 'ë¯¸ì ìš© (HTTP)';
                securityStatusDisplay.classList.remove('status-value-success');
                securityStatusDisplay.classList.add('status-value-error');

                confirmRegisterDomain.textContent = 'í™•ì¸';
                confirmRegisterDomain.disabled = false;
                isRegisteringDomain = false;
            }
        });

        // ë„ë©”ì¸ ë“±ë¡ ì™„ë£Œ í›„ í™•ì¸ ë²„íŠ¼
        confirmRegisterDomain.addEventListener('click', (event) => {
            if (!isRegisteringDomain && confirmRegisterDomain.textContent === 'í™•ì¸') {
                event.stopImmediatePropagation();

                registerDomainModal.classList.add('hidden-modal');
                document.getElementById('registerModalText').classList.remove('hidden-modal');
                document.getElementById('registerProgressContainer').classList.add('hidden-modal');
                confirmRegisterDomain.textContent = 'ë“±ë¡';
                confirmRegisterDomain.disabled = false;
            }
        }, true);

        // ë„ë©”ì¸ ë“±ë¡ ì·¨ì†Œ
        cancelRegisterDomain.addEventListener('click', () => {
            registerDomainModal.classList.add('hidden-modal');
            document.getElementById('registerModalText').classList.remove('hidden-modal');
            document.getElementById('registerProgressContainer').classList.add('hidden-modal');
            confirmRegisterDomain.textContent = 'ë“±ë¡';
            confirmRegisterDomain.disabled = false;
        });

        // ë„ë©”ì¸ í•´ì œ ë²„íŠ¼ í´ë¦­
        releaseDomainButton.addEventListener('click', () => {
            const registeredDomain = currentDomainDisplay.textContent.trim();

            if (registeredDomain === 'ì—†ìŒ' || !registeredDomain) {
                showMessage("ì˜¤ë¥˜", "í•´ì œí•  ë„ë©”ì¸ì´ ì—†ìŠµë‹ˆë‹¤.<br>ë¨¼ì € ë„ë©”ì¸ì„ ë“±ë¡í•´ì£¼ì„¸ìš”.", false);
                return;
            }

            releaseDomainModal.classList.remove('hidden-modal');
        });

        // ë„ë©”ì¸ í•´ì œ í™•ì¸ (SSE)
        let isReleasingDomain = false;

        confirmReleaseDomain.addEventListener('click', async () => {
            if (isReleasingDomain) return;

            const ipAddress = homeIp;

            if (!ipAddress || ipAddress === '') {
                showMessage("ì˜¤ë¥˜", "ìœ íš¨í•œ ê´€ë¦¬ì IP ì£¼ì†Œë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê±°ë‚˜ ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.", false);
                return;
            }

            const releaseModalText = document.getElementById('releaseModalText');
            const releaseProgressContainer = document.getElementById('releaseProgressContainer');
            const releaseProgressText = document.getElementById('releaseProgressText');

            releaseModalText.classList.add('hidden-modal');
            releaseProgressContainer.classList.remove('hidden-modal');
            releaseProgressText.textContent = 'â³ ë„ë©”ì¸ í•´ì œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...';
            releaseProgressText.className = 'progress-text';

            confirmReleaseDomain.disabled = true;
            isReleasingDomain = true;

            try {
                const response = await fetch(`${DOMAIN_BASE_URL}/release_security`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ ip: ipAddress })
                });

                if (!response.ok) throw new Error(`ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ${response.status}`);

                const reader = response.body.getReader();
                const decoder = new TextDecoder();
                let buffer = '';

                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;

                    buffer += decoder.decode(value, { stream: true });
                    const lines = buffer.split('\n');
                    buffer = lines.pop() || '';

                    for (const line of lines) {
                        if (line.startsWith('data: ')) {
                            const jsonStr = line.substring(6).trim();
                            if (!jsonStr) continue;

                            try {
                                const data = JSON.parse(jsonStr);

                                if (data.status === 'progress') {
                                    releaseProgressText.textContent = `${data.message}`;
                                    releaseProgressText.className = 'progress-text';
                                } else if (data.status === 'success') {
                                    currentDomainDisplay.textContent = 'ì—†ìŒ';
                                    currentDomain = '';
                                    domainInput.value = '';

                                    securityStatusDisplay.textContent = 'ë¯¸ì ìš© (HTTP)';
                                    securityStatusDisplay.classList.remove('status-value-success');
                                    securityStatusDisplay.classList.add('status-value-error');

                                    releaseProgressText.textContent = 'ë„ë©”ì¸ í•´ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.';
                                    releaseProgressText.className = 'progress-text success';

                                    updateReleaseButtonState();
                                    updateDomainAccessButton();
                                    validateWebhookEndpoint(); // ì›¹í›… URL ì—…ë°ì´íŠ¸

                                    confirmReleaseDomain.textContent = 'í™•ì¸';
                                    confirmReleaseDomain.disabled = false;
                                    confirmReleaseDomain.classList.remove('delete-button-confirm');
                                    confirmReleaseDomain.classList.add('accent-color-bg');

                                    isReleasingDomain = false;
                                    break;
                                } else if (data.status === 'error') {
                                    releaseProgressText.textContent = `í•´ì œ ì‹¤íŒ¨: ${data.message}`;
                                    releaseProgressText.className = 'progress-text error';

                                    confirmReleaseDomain.textContent = 'í™•ì¸';
                                    confirmReleaseDomain.disabled = false;
                                    isReleasingDomain = false;
                                    break;
                                }
                            } catch (parseError) {
                                console.error("JSON íŒŒì‹± ì˜¤ë¥˜:", parseError);
                            }
                        }
                    }
                }
            } catch (error) {
                releaseProgressText.textContent = `âŒ ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`;
                releaseProgressText.className = 'progress-text error';

                confirmReleaseDomain.textContent = 'í™•ì¸';
                confirmReleaseDomain.disabled = false;
                isReleasingDomain = false;
            }
        });

        // ë„ë©”ì¸ í•´ì œ ì™„ë£Œ í›„ í™•ì¸ ë²„íŠ¼
        confirmReleaseDomain.addEventListener('click', (event) => {
            if (!isReleasingDomain && confirmReleaseDomain.textContent === 'í™•ì¸') {
                event.stopImmediatePropagation();

                releaseDomainModal.classList.add('hidden-modal');
                document.getElementById('releaseModalText').classList.remove('hidden-modal');
                document.getElementById('releaseProgressContainer').classList.add('hidden-modal');
                confirmReleaseDomain.textContent = 'í•´ì œ';
                confirmReleaseDomain.disabled = false;
                confirmReleaseDomain.classList.remove('accent-color-bg');
                confirmReleaseDomain.classList.add('delete-button-confirm');
            }
        }, true);

        // ë„ë©”ì¸ í•´ì œ ì·¨ì†Œ
        cancelReleaseDomain.addEventListener('click', () => {
            releaseDomainModal.classList.add('hidden-modal');
            document.getElementById('releaseModalText').classList.remove('hidden-modal');
            document.getElementById('releaseProgressContainer').classList.add('hidden-modal');
            confirmReleaseDomain.textContent = 'í•´ì œ';
            confirmReleaseDomain.disabled = false;
            confirmReleaseDomain.classList.remove('accent-color-bg');
            confirmReleaseDomain.classList.add('delete-button-confirm');
        });

        // ====================================================
        // ì›¹í›… ê´€ë¦¬ ë¡œì§
        // ====================================================

        // ì…ë ¥ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬
        const validateInput = () => {
            const password = webhookInput.value.trim();
            const isValid = password.length >= 4;

            registerButton.disabled = !isValid;

            // ì…ë ¥ í•„ë“œì— ê°’ì´ ìˆìœ¼ë©´ í•´ì œ ë²„íŠ¼ í™œì„±í™”
            if (password) {
                releaseButton.disabled = false;
            }
        };

        webhookInput.addEventListener('input', validateInput);
        validateInput();

        // ë“±ë¡ ë²„íŠ¼ í´ë¦­
        registerButton.addEventListener('click', () => {
            const password = webhookInput.value.trim();

            if (!password) {
                showMessage("ì˜¤ë¥˜", "ì›¹í›… íŒ¨ìŠ¤ì›Œë“œë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.", false);
                return;
            }

            if (password.length < 4) {
                showMessage("ì˜¤ë¥˜", "ì›¹í›… íŒ¨ìŠ¤ì›Œë“œëŠ” ìµœì†Œ 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.", false);
                return;
            }

            registerModal.classList.remove('hidden-modal');
        });

        // ë“±ë¡ í™•ì¸
        confirmRegister.addEventListener('click', async () => {
            const password = webhookInput.value.trim();

            confirmRegister.disabled = true;
            confirmRegister.textContent = 'ë“±ë¡ ì¤‘...';

            try {
                const formData = new FormData();
                formData.append('webhook_password', password);

                const response = await fetch(`${BASE_URL}/register_webhook`, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (response.ok) {
                    registerModal.classList.add('hidden-modal');
                    showMessage("ë“±ë¡ ì™„ë£Œ", data.message, true);
                    releaseButton.disabled = false;
                } else {
                    registerModal.classList.add('hidden-modal');
                    showMessage("ë“±ë¡ ì‹¤íŒ¨", data.detail || "ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", false);
                }
            } catch (error) {
                registerModal.classList.add('hidden-modal');
                showMessage("ì˜¤ë¥˜", `ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`, false);
            } finally {
                confirmRegister.disabled = false;
                confirmRegister.textContent = 'ë“±ë¡';
            }
        });

        // ë“±ë¡ ì·¨ì†Œ
        cancelRegister.addEventListener('click', () => {
            registerModal.classList.add('hidden-modal');
        });

        // í•´ì œ ë²„íŠ¼ í´ë¦­
        releaseButton.addEventListener('click', () => {
            releaseModal.classList.remove('hidden-modal');
        });

        // í•´ì œ í™•ì¸
        confirmRelease.addEventListener('click', async () => {
            confirmRelease.disabled = true;
            confirmRelease.textContent = 'í•´ì œ ì¤‘...';

            try {
                const response = await fetch(`${BASE_URL}/release_webhook`, {
                    method: 'POST'
                });

                const data = await response.json();

                if (response.ok) {
                    releaseModal.classList.add('hidden-modal');
                    showMessage("í•´ì œ ì™„ë£Œ", data.message, true);
                    webhookInput.value = '';
                    releaseButton.disabled = true;
                    registerButton.disabled = true;
                } else {
                    releaseModal.classList.add('hidden-modal');
                    showMessage("í•´ì œ ì‹¤íŒ¨", data.detail || "í•´ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", false);
                }
            } catch (error) {
                releaseModal.classList.add('hidden-modal');
                showMessage("ì˜¤ë¥˜", `ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`, false);
            } finally {
                confirmRelease.disabled = false;
                confirmRelease.textContent = 'í•´ì œ';
            }
        });

        // í•´ì œ ì·¨ì†Œ
        cancelRelease.addEventListener('click', () => {
            releaseModal.classList.add('hidden-modal');
        });

        // ====================================================
        // ì›¹í›… ì£¼ì†Œ ê´€ë¦¬ ë¡œì§
        // ====================================================

        const webhookEndpointInput = document.getElementById('webhook-endpoint-input');
        const registerEndpointButton = document.getElementById('registerEndpointButton');
        const releaseEndpointButton = document.getElementById('releaseEndpointButton');
        const webhookFullUrl = document.getElementById('webhookFullUrl');
        const copyWebhookUrlButton = document.getElementById('copyWebhookUrlButton');

        // ì›¹í›… ì£¼ì†Œ ìœ íš¨ì„± ê²€ì‚¬ ë° ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        const validateWebhookEndpoint = () => {
            let inputValue = webhookEndpointInput.value.trim();

            // / ë¡œ ì‹œì‘í•˜ë©´ ì œê±° (ì…ë ¥ í•„ë“œì—ì„œëŠ” / ì—†ì´ í‘œì‹œ)
            if (inputValue.startsWith('/')) {
                inputValue = inputValue.substring(1);
                webhookEndpointInput.value = inputValue;
            }

            // ì›¹í›… URL ìƒì„± ì‹œì—ëŠ” / ìë™ ì¶”ê°€
            let endpoint = inputValue ? '/' + inputValue : '/webhook';

            // ë„ë©”ì¸ì´ ìˆìœ¼ë©´ ë„ë©”ì¸ ì‚¬ìš©, ì—†ìœ¼ë©´ ê´€ë¦¬ì IP ì‚¬ìš©
            const domain = currentDomain && currentDomain !== 'ì—†ìŒ' ? currentDomain : '';
            const host = domain || homeIp;
            const protocol = domain ? 'https' : 'http';
            webhookFullUrl.textContent = `${protocol}://${host}${endpoint}`;

            // ë“±ë¡ ë²„íŠ¼: ì…ë ¥ê°’ì´ ìˆìœ¼ë©´ í™œì„±í™”
            if (inputValue && inputValue !== '') {
                registerEndpointButton.disabled = false;
            } else {
                registerEndpointButton.disabled = true;
            }

            // í•´ì œ ë²„íŠ¼: í˜„ì¬ ê°’ì´ ê¸°ë³¸ê°’ì´ ì•„ë‹Œ ê²½ìš° í™œì„±í™”
            const isDefaultValue = (inputValue === 'webhook' || inputValue === '');
            if (inputValue && !isDefaultValue) {
                releaseEndpointButton.disabled = false;
            } else {
                releaseEndpointButton.disabled = true;
            }
        };

        webhookEndpointInput.addEventListener('input', validateWebhookEndpoint);

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ìƒíƒœ ì„¤ì •
        validateWebhookEndpoint();

        // ì›¹í›… ì£¼ì†Œ ë“±ë¡ ëª¨ë‹¬
        const registerEndpointModal = document.getElementById('registerEndpointModal');
        const confirmRegisterEndpoint = document.getElementById('confirmRegisterEndpoint');
        const cancelRegisterEndpoint = document.getElementById('cancelRegisterEndpoint');

        // ì›¹í›… ì£¼ì†Œ í•´ì œ ëª¨ë‹¬
        const releaseEndpointModal = document.getElementById('releaseEndpointModal');
        const confirmReleaseEndpoint = document.getElementById('confirmReleaseEndpoint');
        const cancelReleaseEndpoint = document.getElementById('cancelReleaseEndpoint');

        // ì›¹í›… ì£¼ì†Œ ë“±ë¡ ë²„íŠ¼ í´ë¦­
        registerEndpointButton.addEventListener('click', () => {
            let endpoint = webhookEndpointInput.value.trim();

            if (!endpoint) {
                showMessage("ì˜¤ë¥˜", "ì›¹í›… ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.", false);
                return;
            }

            registerEndpointModal.classList.remove('hidden-modal');
        });

        // ì›¹í›… ì£¼ì†Œ ë“±ë¡ í™•ì¸
        confirmRegisterEndpoint.addEventListener('click', async () => {
            let endpoint = webhookEndpointInput.value.trim();

            // / ë¡œ ì‹œì‘í•˜ë„ë¡ ë³´ì¥
            if (!endpoint.startsWith('/')) {
                endpoint = '/' + endpoint;
            }

            confirmRegisterEndpoint.disabled = true;
            confirmRegisterEndpoint.textContent = 'ë“±ë¡ ì¤‘...';

            try {
                const formData = new FormData();
                formData.append('webhook_endpoint', endpoint);

                const response = await fetch(`${BASE_URL}/register_endpoint`, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (response.ok) {
                    registerEndpointModal.classList.add('hidden-modal');
                    showMessage("ë“±ë¡ ì™„ë£Œ", data.message, true);
                    webhookEndpointInput.value = endpoint;
                    validateWebhookEndpoint();
                } else {
                    registerEndpointModal.classList.add('hidden-modal');
                    showMessage("ë“±ë¡ ì‹¤íŒ¨", data.detail || "ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", false);
                }
            } catch (error) {
                registerEndpointModal.classList.add('hidden-modal');
                showMessage("ì˜¤ë¥˜", `ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`, false);
            } finally {
                confirmRegisterEndpoint.disabled = false;
                confirmRegisterEndpoint.textContent = 'ë“±ë¡';
            }
        });

        // ì›¹í›… ì£¼ì†Œ ë“±ë¡ ì·¨ì†Œ
        cancelRegisterEndpoint.addEventListener('click', () => {
            registerEndpointModal.classList.add('hidden-modal');
        });

        // ì›¹í›… ì£¼ì†Œ í•´ì œ ë²„íŠ¼ í´ë¦­
        releaseEndpointButton.addEventListener('click', () => {
            releaseEndpointModal.classList.remove('hidden-modal');
        });

        // ì›¹í›… ì£¼ì†Œ í•´ì œ í™•ì¸
        confirmReleaseEndpoint.addEventListener('click', async () => {
            confirmReleaseEndpoint.disabled = true;
            confirmReleaseEndpoint.textContent = 'í•´ì œ ì¤‘...';

            try {
                const response = await fetch(`${BASE_URL}/release_endpoint`, {
                    method: 'POST'
                });

                const data = await response.json();

                if (response.ok) {
                    releaseEndpointModal.classList.add('hidden-modal');
                    showMessage("í•´ì œ ì™„ë£Œ", data.message, true);
                    webhookEndpointInput.value = 'webhook';
                    validateWebhookEndpoint();
                } else {
                    releaseEndpointModal.classList.add('hidden-modal');
                    showMessage("í•´ì œ ì‹¤íŒ¨", data.detail || "í•´ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", false);
                }
            } catch (error) {
                releaseEndpointModal.classList.add('hidden-modal');
                showMessage("ì˜¤ë¥˜", `ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`, false);
            } finally {
                confirmReleaseEndpoint.disabled = false;
                confirmReleaseEndpoint.textContent = 'í•´ì œ';
            }
        });

        // ì›¹í›… ì£¼ì†Œ í•´ì œ ì·¨ì†Œ
        cancelReleaseEndpoint.addEventListener('click', () => {
            releaseEndpointModal.classList.add('hidden-modal');
        });

        // ì›¹í›… URL ë³µì‚¬
        copyWebhookUrlButton.addEventListener('click', () => {
            const url = webhookFullUrl.textContent;
            navigator.clipboard.writeText(url).then(() => {
                showMessage("ë³µì‚¬ ì™„ë£Œ", "ì›¹í›… URLì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.", true);
            }).catch(err => {
                showMessage("ë³µì‚¬ ì‹¤íŒ¨", "URL ë³µì‚¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", false);
            });
        });

        // JSON ë³µì‚¬
        const copyJsonButton = document.getElementById('copyJsonButton');
        const tradingviewJson = document.getElementById('tradingviewJson');

        copyJsonButton.addEventListener('click', () => {
            const jsonText = tradingviewJson.textContent;
            navigator.clipboard.writeText(jsonText).then(() => {
                showMessage("ë³µì‚¬ ì™„ë£Œ", "JSONì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.", true);
            }).catch(err => {
                showMessage("ë³µì‚¬ ì‹¤íŒ¨", "JSON ë³µì‚¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", false);
            });
        });

        // ====================================================
        // ì ‘ê·¼ í—ˆìš© IP ê´€ë¦¬ ë¡œì§
        // ====================================================

        const allowedIpsInput = document.getElementById('allowed-ips-input');
        const registerIpsButton = document.getElementById('registerIpsButton');
        const releaseIpsButton = document.getElementById('releaseIpsButton');

        // ì„œë²„ì—ì„œ ì „ë‹¬ëœ ê¸°ë³¸ê°’ (admin_ip í¬í•¨)
        const defaultAllowedIps = '{{ default_allowed_ips }}';

        // IP ì…ë ¥ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬
        const validateAllowedIps = () => {
            const ips = allowedIpsInput.value.trim();

            // ê¸°ë³¸ê°’ì´ë©´ í•´ì œ ë²„íŠ¼ ë¹„í™œì„±í™”
            if (ips === defaultAllowedIps || ips === '') {
                releaseIpsButton.disabled = true;
            } else {
                releaseIpsButton.disabled = false;
            }
        };

        // ì…ë ¥ í•„ë“œ ë³€ê²½ ì‹œ ê²€ì¦
        allowedIpsInput.addEventListener('input', validateAllowedIps);

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ê²€ì¦
        validateAllowedIps();

        // IP ë“±ë¡
        registerIpsButton.addEventListener('click', async () => {
            const ips = allowedIpsInput.value.trim();

            if (!ips) {
                showMessage("ì˜¤ë¥˜", "í—ˆìš©í•  IP ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.", false);
                return;
            }

            registerIpsButton.disabled = true;
            registerIpsButton.textContent = 'ë“±ë¡ ì¤‘...';

            try {
                const formData = new FormData();
                formData.append('allowed_ips', ips);

                const response = await fetch(`${BASE_URL}/register_ips`, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (response.ok) {
                    showMessage("ë“±ë¡ ì™„ë£Œ", data.message, true);
                    validateAllowedIps(); // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
                } else {
                    showMessage("ë“±ë¡ ì‹¤íŒ¨", data.detail || "ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", false);
                }
            } catch (error) {
                showMessage("ì˜¤ë¥˜", `ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`, false);
            } finally {
                registerIpsButton.disabled = false;
                registerIpsButton.textContent = 'ì ‘ê·¼ í—ˆìš© IP ë“±ë¡';
            }
        });

        // IP í•´ì œ (ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”)
        releaseIpsButton.addEventListener('click', async () => {
            releaseIpsButton.disabled = true;
            releaseIpsButton.textContent = 'í•´ì œ ì¤‘...';

            try {
                const response = await fetch(`${BASE_URL}/release_ips`, {
                    method: 'POST'
                });

                const data = await response.json();

                if (response.ok) {
                    showMessage("í•´ì œ ì™„ë£Œ", data.message, true);
                    allowedIpsInput.value = defaultAllowedIps;
                    validateAllowedIps(); // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸ (ë¹„í™œì„±í™”)
                } else {
                    showMessage("í•´ì œ ì‹¤íŒ¨", data.detail || "í•´ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.", false);
                }
            } catch (error) {
                showMessage("ì˜¤ë¥˜", `ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`, false);
            } finally {
                releaseIpsButton.disabled = false;
                releaseIpsButton.textContent = 'ì ‘ê·¼ í—ˆìš© IP í•´ì œ';
            }
        });

        // ====================================================
        // ë¹„ë°€ë²ˆí˜¸ í‘œì‹œ/ìˆ¨ê¹€ í† ê¸€
        // ====================================================
        document.querySelectorAll('.password-toggle-btn').forEach(button => {
            button.addEventListener('click', () => {
                const targetId = button.getAttribute('data-target');
                const input = document.getElementById(targetId);
                const eyeIcon = button.querySelector('.eye-icon');
                const eyeSlashIcon = button.querySelector('.eye-slash-icon');

                if (input.type === 'password') {
                    input.type = 'text';
                    eyeIcon.style.display = 'none';
                    eyeSlashIcon.style.display = 'block';
                } else {
                    input.type = 'password';
                    eyeIcon.style.display = 'block';
                    eyeSlashIcon.style.display = 'none';
                }
            });
        });

        console.log("ë³´ì•ˆ ê´€ë¦¬ í˜ì´ì§€ ë¡œë“œë¨.");
    });
</script>
{% endblock %}